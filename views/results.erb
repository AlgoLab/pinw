<head>
  <title>PIntron | Results</title>

  <%# JS & CSS #%>
  <%= erb :'/includes/header' %>

</head>
<body>

  <%# HEADER #%>
  <%= erb :'/includes/navbar' %>


  <%# PAGE CODE HERE #%>

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="page-header">
          <h1><i class="fa fa-flag-checkered"></i> Results <small></small></h1>
        </div>
      </div>
    </div>
    <div class="row">
      <% if session[:user] %>
        <div class="col-md-3">
          <div class="panel panel-default panel-primary result">
            <div class="panel-heading">Last results</div>
            <table class="table table-condensed table-result table-result-hover hidden-border">
              <tbody>
                <% session[:user].results.each do |result| %>
                  <tr>
                    <td><div class='divBox'><a href='/result/1'><% result.job_id %></a></div></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
        <div class="col-md-9">
      <% else %>
        <div class="col-md-12">
      <% end %>
        <% if params[:ok] == '1' %>
          <div class="alert alert-success">
            <p><strong><i class="fa fa-save"></i> Everything is awesome!</strong>
          </div>
        <% end %>

        <% if params[:err] == '1' %>
          <div class="alert alert-danger">
            <p><strong><i class="fa fa-warning"></i> Error! </strong> You have already reached your maximum amount of jobs queued!
          </div>
        <% end %>
          <div class="row">
            <div class="col-md-12">
              <div class="panel panel-default panel-primary result">
                <div class="panel-heading">Search by genomics</div>
                <br />
                <form class="form-horizontal" role="form" method="get" action="/results">
                  <div class="form-group">
                    <label for="InputOrganism" class="col-sm-3 control-label">Organism name</label>
                    <div class="col-sm-6">
                      <select class="form-control" id="InputOrganism"  name="InputOrganism" required>
                        <% organism_list.each do |organism| %>
                          <option value="<%= organism.id %>"><%= organism.name %></option>
                        <% end %>
                      </select>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="InputGeneName" class="col-sm-3 control-label">Gene name</label>
                    <div class="col-sm-6">
                      <input type="text" class="form-control" id="InputGeneName" name="InputGeneName" placeholder="es: caramel banana" pattern="([\S]+)( [\S]+)*" title="Invalid input: insert genes separated by a space">
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="InputRefSeq" class="col-sm-3 control-label">Ref Sequence</label>
                    <div class="col-sm-6">
                      <input type="text" class="form-control" id="InputRefSeq" name="InputRefSeq" placeholder="es: NM_123 NM_456" pattern="(NM_[\S]+)( NM_[\S]+)*" title="Invalid input: insert ref seq separated by a space">
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="col-sm-offset-3 col-sm-6">
                      <button type="submit" class="btn btn-default btn-primary">Search</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">

        
      </div>


    </div>

      <% if results %>
        <% results.each do |r| %>
        <div class="row">
          <div class="col-md-12">
            <%= r.gene_name %> <br>
            <%= r.organism.name if r.organism %>
          </div>
        </div>
        <% end %>
        <%= will_paginate results %>
      <% end %>


  <%# FOOTER #%>
  <%= erb :'/includes/footer' %>
</body>
